<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Order Form for Moving Services</title>
    <link rel="stylesheet" href="css/styles.css"> <!-- Global styles -->
    <link rel="stylesheet" href="css/order-form.css"> <!-- Order form specific styles -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            document.querySelectorAll('.category h2').forEach(categoryHeader => {
                categoryHeader.addEventListener('click', () => {
                    const category = categoryHeader.parentElement;
                    category.classList.toggle('active');
                    const content = categoryHeader.nextElementSibling;
                    content.style.display = content.style.display === 'block' ? 'none' : 'block';
                });
            });
        });

        function updateCount(button, inputId, increment) {
            const input = document.getElementById(inputId);
            let currentValue = parseInt(input.value);
            if (increment) {
                input.value = currentValue + 1;
            } else if (currentValue > 0) {
                input.value = currentValue - 1;
            }
        }
    </script>
</head>
<body>
    <div class="container">
        <!-- Angebot Anfragen Section -->
        <section class="section">
            <h2>ANGEBOT ANFRAGEN</h2>
            <p>
                Auf dieser Seite gibt es ein Anfrageformular, mit dem Sie die geschätzten <em>Kosten</em> für Ihren Umzug oder Ihre Entrümpelung anfragen können. Füllen Sie alle Felder des Formulars für eine genauere Berechnung aus, wir werden Ihnen ein kostenloses und unverbindliches Angebot für Ihren Umzug oder Entrümpelung erstellen.
            </p>
            <p>
                Sollte das Datum für Ihren Umzug oder Entrümpelung noch nicht genau bekannt sein, dann fügen Sie ein ungefähres Datum ein und notieren dies in der Beschreibung.
            </p>
        </section>

        <!-- Kontakt Section -->
	<section class="contact-section">
		<h2>Kontakt</h2>
		<form id="contact-form" action="/submit" method="POST" enctype="multipart/form-data" class="contact-form">
			<div class="contact-form">
				<input type="text" name="name" placeholder="Name*" required>
				<input type="text" name="surname" placeholder="Vorname*" required>
				<input type="email" name="email" placeholder="E-Mail*" required>
				<input type="tel" name="phone" placeholder="Telefon">
				<textarea name="message" placeholder="Your message" required style="flex: 1 1 100%; height: 100px;"></textarea>
				<input type="file" name="files" accept="image/*,video/*" multiple style="flex: 1 1 100%; margin-top: 10px;">
			</div>
			<div class="submit-section">
				<button type="submit" class="submit-button">ANGEBOT KOSTENLOS EINHOLEN</button>
			</div>
		</form>
	</section>

	<script>
		// Function to update counters (assuming the function exists in your script)
		function updateCount(button, inputId, increment) {
			const input = document.getElementById(inputId);
			let count = parseInt(input.value);
			count = increment ? count + 1 : count - 1;
			input.value = count > 0 ? count : 0; // Ensure count doesn't go below 0
		}

		// Collect all category data
		function getCategoryData() {
			const categories = [];
			document.querySelectorAll(".category").forEach((categorySection) => {
				const categoryTitle = categorySection.querySelector("h2").textContent;
				const items = [];

				categorySection.querySelectorAll(".item").forEach((item) => {
					const itemName = item.querySelector("span").textContent;
					const itemCount = parseInt(item.querySelector("input[type='text']").value);

					items.push({ name: itemName, count: itemCount });
				});

				categories.push({ category: categoryTitle, items: items });
			});

			return categories;
		}

		// Event listener for form submission
		document.getElementById("contact-form").addEventListener("submit", function(event) {
			event.preventDefault(); // Prevent the default form submission

			// Get form data
			const formData = new FormData(this);

			// Add category data to formData
			const categoryData = JSON.stringify(getCategoryData());
			formData.append("categories", categoryData);

			// Send form data to the backend
			fetch("http://localhost:5000/submit", {  // Adjust URL if necessary
				method: "POST",
				body: formData
			})
			.then(response => response.json())
			.then(data => {
				if (data.status === "success") {
					// Redirect to the thank-you page on success
					window.location.href = "http://localhost:8080/danke.html";
				} else {
					alert("There was an error submitting the form. Please try again.");
				}
			})
			.catch(error => {
				console.error("Error:", error);
				alert("An error occurred. Please try again.");
			});
		});
	</script>





    <section class="category">
        <h2>Bad & WC</h2>
        <div class="content">
            <div class="item">
                <span>Schrank 2 Türen, n. zerleg.</span>
                <div class="counter">
                    <button onclick="updateCount(this, 'schrank2TCount', false)">-</button>
                    <input type="text" id="schrank2TCount" value="0" readonly>
                    <button onclick="updateCount(this, 'schrank2TCount', true)">+</button>
                </div>
            </div>
            <div class="item">
                <span>Schrank, zerl. je angef. m</span>
                <div class="counter">
                    <button onclick="updateCount(this, 'schrankZCount', false)">-</button>
                    <input type="text" id="schrankZCount" value="0" readonly>
                    <button onclick="updateCount(this, 'schrankZCount', true)">+</button>
                </div>
            </div>
            <div class="item">
                <span>Waschmaschine / Trockner</span>
                <div class="counter">
                    <button onclick="updateCount(this, 'waschmaschineCount', false)">-</button>
                    <input type="text" id="waschmaschineCount" value="0" readonly>
                    <button onclick="updateCount(this, 'waschmaschineCount', true)">+</button>
                </div>
            </div>
            <!-- Additional items here -->
        </div>
    </section>

    <section class="category">
        <h2>Arbeiten</h2>
        <div class="content">
            <div class="item">
                <span>Aktenschrank, je lfd. m</span>
                <div class="counter">
                    <button onclick="updateCount(this, 'aktenschrankCount', false)">-</button>
                    <input type="text" id="aktenschrankCount" value="0" readonly>
                    <button onclick="updateCount(this, 'aktenschrankCount', true)">+</button>
                </div>
            </div>
            <div class="item">
                <span>Schreibtisch bis 1,6 m</span>
                <div class="counter">
                    <button onclick="updateCount(this, 'schreibtischBCount', false)">-</button>
                    <input type="text" id="schreibtischBCount" value="0" readonly>
                    <button onclick="updateCount(this, 'schreibtischBCount', true)">+</button>
                </div>
            </div>
            <!-- Additional items here -->
        </div>
    </section>
    </div>
</body>
</html>
